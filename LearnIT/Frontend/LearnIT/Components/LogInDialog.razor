@using MudBlazor;
@using Components;
@using System.Text.RegularExpressions
@using System.ComponentModel.DataAnnotations
@using DTOs;
@using Shared;
@inject IDialogService DialogService;
<MudDialog>
    <DialogContent>
        <MudGrid Justify="Justify.Center">
            <MudItem>
                <MudAvatar Style="width:150px; height:150px;" Color="Color.Primary" Variant="Variant.Outlined">
                    <MudIcon Style="width:150px; height:150px;" Icon="@Icons.Material.Filled.Person" />
                </MudAvatar>
            </MudItem>
            <MudItem xs="12" sm="22">
                <MudForm @bind-IsValid="@_success">                
                    <MudTextField T="string" @bind-Value="_email" Label="Email" Required="true" RequiredError="Email is required!"
                                  Validation="@(new EmailAddressAttribute() {ErrorMessage = "The email address is invalid"})" />
                    <MudTextField T="string" Label="Password"
                                  InputType="InputType.Password"
                                  Required="true"
                                  RequiredError="Password is required!"
                                  @bind-Value="_password" />

                    <MudCheckBox T="bool" Label="Remember me" />
                    <br>
                    <MudStack Justify="Justify.FlexStart" Row="true">
                        <MudButton Variant="Variant.Filled" OnClick="OnCancelClick" Color="Color.Primary" Class="ml-auto">Cancel</MudButton>
                        <MudSpacer/>
                        <MudButton Variant="Variant.Filled" OnClick="OnLogInClick" Color="Color.Primary" Disabled="@(!_success)" Class="ml-auto">Log In</MudButton>
                    </MudStack>
                </MudForm>
            </MudItem>
        </MudGrid>
    </DialogContent>
</MudDialog>
@code {
    [CascadingParameter]
    MudDialogInstance MudDialog { get; set; } = null!;
    [Parameter]
    public EventCallback<UserLoginModel> UserLoginModel { get; set; }

    private string _email = null!;
    private bool _success;
    string _password = null!;
    private bool _rememberMe;

    private void OnLogInClick()
    {
        UserLoginModel userLoginModel = new UserLoginModel { Email = _email, Password = _password };
        MudDialog.Close(userLoginModel);
    }

    private void OnCancelClick()
    {
        MudDialog.Close();
    }
}
